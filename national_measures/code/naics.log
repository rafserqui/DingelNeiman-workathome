
  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   14.2   Copyright 1985-2015 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 8-core Stata perpetual license:
       Serial number:  10699393
         Licensed to:  Rafael
                       

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do "naics.do" 

. clear all

. foreach package in listtex {
  2.     capture which `package'
  3.     if _rc==111 ssc install `package'
  4. }

. 
. 
. //BN-JD coding of teleworkability
. //LOAD NAICS-SOC data
. import excel using "../input/natsector_M2018_dl.xlsx", clear firstrow

. keep if OCC_GROUP=="broad"
(10,478 observations deleted)

. //Merge with BN-JD coding of teleworkability
. clonevar BroadGroupCode = OCC_CODE

. merge m:1 BroadGroupCode using "../input/Teleworkable_BNJDopinion.dta", asser
> t(using match) keep(match) nogen

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                             5,814  
    -----------------------------------------

. rename Teleworkable teleworkable

. //Generate employment-weighted and wage-weighted means
. destring TOT_EMP, replace ig(*)
TOT_EMP: character * removed; replaced as long
(325 missing values generated)

. bys NAICS: egen emp_denom  = total(TOT_EMP)

. bys NAICS: egen emp_numer  = total(teleworkable*TOT_EMP)

. replace H_MEAN = "100" if H_MEAN=="#"
(0 real changes made)

. destring H_MEAN, replace ig(*)
H_MEAN: character * removed; replaced as double
(179 missing values generated)

. bys NAICS: egen wage_denom = total(H_MEAN*TOT_EMP*(missing(H_MEAN)==0))

. bys NAICS: egen wage_numer = total(teleworkable*H_MEAN*TOT_EMP*(missing(H_MEA
> N)==0))

. gen teleworkable_emp = emp_numer / emp_denom

. gen teleworkable_wage = wage_numer / wage_denom

. //Industry-level results
. keep NAICS NAICS_TITLE teleworkable_emp teleworkable_wage

. duplicates drop

Duplicates in terms of all variables

(5,794 observations deleted)

. //Report results in CSV 
. tempfile tf_forcsv_manual

. save `tf_forcsv_manual'
file C:\Users\Rafael\AppData\Local\Temp\ST_00000001.tmp saved

. 
. //Report results in statements and tables
. tempvar tv1 tv2

. egen `tv1' = rank(teleworkable_emp), field

. egen `tv2' = rank(teleworkable_emp), track

. 
. keep if inrange(`tv1',1,5) | inrange(`tv2',1,5)
(10 observations deleted)

. gen row = (`tv1')*inrange(`tv1',1,5) + (11-`tv2')*inrange(`tv2',1,5)

. sort row

. list NAICS_TITLE teleworkable_emp teleworkable_wage row

     +------------------------------------------------------------------------+
  1. |                                      NAICS_TITLE | telewo~p | telewo~e |
     | Professional, Scientific, and Technical Services | .7588456 | .8210521 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    1                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  2. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |          Management of Companies and Enterprises |  .754783 | .8220609 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    2                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  3. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |                            Finance and Insurance | .7313789 |  .807745 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    3                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  4. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |                             Educational Services | .7094851 |  .611747 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    4                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  5. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |                                      Information | .6232744 | .7207445 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    5                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  6. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |                                     Construction | .1435316 | .1894506 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    6                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  7. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |                   Transportation and Warehousing | .1369015 | .1855447 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    7                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  8. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |                                     Retail Trade | .1120365 | .1786506 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    8                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  9. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |       Agriculture, Forestry, Fishing and Hunting | .0547347 | .1069502 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                    9                                   |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
 10. |                                      NAICS_TITLE | telewo~p | telewo~e |
     |                  Accommodation and Food Services | .0277662 | .0619518 |
     |------------------------------------------------------------------------|
     |                                  row                                   |
     |                                   10                                   |
     +------------------------------------------------------------------------+

. gen str tele_emp_str = string(teleworkable_emp,"%3.2f")

. gen str tele_wage_str = string(teleworkable_wage,"%3.2f")

. 
. 
. sort row

. qui summarize teleworkable_emp if row==1

. local top_num = string(100*`r(mean)',"%3.0f")

. local top_ind = NAICS_TITLE[1]

. qui summarize teleworkable_emp if row==10

. local bot_num = string(100*`r(mean)',"%3.0f")

. local bot_ind = NAICS_TITLE[10]

. shell echo -n "from `bot_num' percent in `bot_ind' to `top_num' percent in `t
> op_ind'%" > ../output/industry_range_manual.tex
request ignored because of batch mode

. 
. gen ind_name = NAICS_TITLE

. replace ind_name = "top5" + NAICS_TITLE if row==1
variable ind_name was str48 now str52
(1 real change made)

. replace ind_name = "bot5" + NAICS_TITLE if row==6
(1 real change made)

. 
. sort row

. listtex ind_name tele_emp_str tele_wage_str using "../output/NAICS_telework_m
> anual_top5bottom5_table.tex", replace ///
> rstyle(tabular) head("\begin{tabular}{lcc} \toprule" "& Unweighted & Weighted
>  by wage\\" "\midrule") foot("\bottomrule \end{tabular}")

. 
. shell sed -i.bak 's/^top5/\\underline{\\textit{Top five}}\\\\/' ../output/NAI
> CS_telework_manual_top5bottom5_table.tex
request ignored because of batch mode

. shell sed -i.bak 's/^bot5/\\\\ \\underline{\\textit{Bottom five}}\\\\/' ../ou
> tput/NAICS_telework_manual_top5bottom5_table.tex
request ignored because of batch mode

. rm ../output/NAICS_telework_manual_top5bottom5_table.tex.bak
file ../output/NAICS_telework_manual_top5bottom5_table.tex.bak not found
r(601);

end of do-file
r(601);
